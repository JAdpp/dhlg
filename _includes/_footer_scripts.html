{% if page.mediaplayer == true %}
<script>
$('audio,video').mediaelementplayer();
</script>
{% endif %}

<script src="{{ url }}/assets/js/morse.js"></script>
<script src="{{ site.url }}{{ site.baseurl }}/assets/js/javascript.js"></script>
<script>
  $('.morse').each(function(){
    var str=$(this).text();
    $(this).text(encodeMorse(str));
  });
  {% if page.layout=="landing" %}
  var sidenavfooterspace=110;
  var sidenavheaderspace=90;
  if(window.matchMedia("(min-width: 40.063em)").matches){

	}else if(window.matchMedia("(min-width: 64.063em)").matches){
  
  }else if(window.matchMedia("(min-width: 90.063em)").matches){
    sidenavfooterspace=50;
    sidenavheaderspace=0;
  }else if(window.matchMedia("(min-width: 120.063em)").matches){
    sidenavfooterspace=50;
    sidenavheaderspace=0;
	}

  var sidenavwidth=$('#sidenav').parent().outerWidth()-26;
  $('#sidenav').css('width',sidenavwidth);
  $('#toc').css('max-height',$(window).innerHeight()-$('.morse:first-of-type','#sidenav').outerHeight(true)-$('h4:first-of-type','#sidenav').outerHeight(true)-30);
  $(window).scroll(function (){
    var top_of_element = $("header").offset().top;
    var bottom_of_element = $("header").offset().top + $("header").outerHeight();
    var bottom_of_screen = $(window).scrollTop() + $(window).innerHeight();
    var top_of_screen = $(window).scrollTop();
    if ((bottom_of_screen > top_of_element) && (top_of_screen < bottom_of_element)){
      $('#sidenav').css({'top':'unset','bottom':'unset'});
      if(window.matchMedia("(min-width: 64.063em)").matches){
        $('#sidenav').css({'position':'relative'});
      }
    } else {
      var footertop_of_element = $("#footer").offset().top;
      var footerbottom_of_element = $("#footer").offset().top + $("#footer").outerHeight();
      var viewablefooter=bottom_of_screen-footertop_of_element+30;
      if ((bottom_of_screen > footertop_of_element) && (top_of_screen < footerbottom_of_element)){
        $('#sidenav').css({'position':'fixed','top':'unset','bottom':viewablefooter});
      } else {
        $('#sidenav').css({'position':'fixed','top':'0','bottom':'unset'});
      }
    }
  });
  $('#tocheader').click(function(){
    $('#toc').toggle();
    if($('#toc').is(":visible")){
      $('#tocheader').addClass('opentoc');
    }else{
      $('#tocheader').removeClass('opentoc');
    }
  });
  $('#toc li').each(function(){
    $(this).click(function(){
      $('html, body').animate({
        {% if page.title == "Scholarly Video Projects" %}
        scrollTop: ($('#project_'+$(this).data('projectid')).offset().top-sidenavheaderspace)
        {% endif %}
        {% if page.title == "Topics in DH" %}
        scrollTop: ($('#topic_'+$(this).data('topicid')).offset().top-sidenavheaderspace)
        {% endif %}
      },500);
      {% if page.title == "Topics in DH" %}
      $('.content','#topics').removeClass('selectedtopic');
      $('li','#toc').removeClass('selectedtocitem');
      $(this).addClass('selectedtocitem');
      $('#topic_'+$(this).data('topicid')).addClass('selectedtopic');
      {% endif %}
      if($('#tocheader').css('pointer-events')=='auto'){
        $('#tocheader').trigger('click');
      }
    });
  });
  $(window).resize(function() {
    var sidenavwidth=$('#sidenav').parent().outerWidth()-26;
    $('#sidenav').css('width',sidenavwidth);
    $('#toc').css('max-height',$(window).innerHeight()-$('.morse:first-of-type','#sidenav').outerHeight(true)-$('h4:first-of-type','#sidenav').outerHeight(true)-sidenavfooterspace);
  });
  {% endif %}
  {% if page.layout=="page" %}
    {% if page.sidebar == NULL %}
    var contentheight=$('#contents').outerHeight();
    $('#sidemorse').css('height',contentheight);
    var sidemorsecount=Math.ceil(contentheight/850);
    for(i = 0; i == sidemorsecount; i++) { 
      var str=encodeMorse('what are dh?');
      $('#sidemorse').append('<p class="morse">'+str+'</p>');
    }
    {% endif %}
  {% endif %}
  {% if page.layout=="frontpage" %}
  if(!$('#frontmenu').is(':visible')){
    $('#navigation .top-bar').css('visibility','visible');
  }
  $('#frontmenu li.has-dropdown').hover(function(){
    $(this).css('height','unset');
    $(this).children('.dropdown').show();
  },function(){
    $(this).css('height','');
    $(this).children('.dropdown').hide();
    $(this).parent('.dropdown').css('height','unset');
    $(this).parent('.dropdown').show();
  });
  {% endif %}
  $('.back.js-generated','.top-bar-section ul').html('&#xf106;');
</script>

{% if page.header.image_fullwidth %}
<script>
    $("#masthead").backstretch("{{ site.urlimg }}{{ page.header.image_fullwidth }}", {fade: 700});
    $("#masthead-with-text").backstretch("{{ site.urlimg }}{{ page.header.image_fullwidth }}", {fade: 700});
</script>
{% endif %}



{% if site.google_analytics_tracking_id %}
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', '{{ site.google_analytics_tracking_id }}', 'auto');
  ga('set', 'anonymizeIp', true);
  ga('send', 'pageview');

</script>
{% endif %}